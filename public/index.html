<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./index.css">
    <meta name="description" content="Explore trendy and personalized hairstyles for Type 4 natural hair. Choose styles by length, texture, and vibe.">
    <meta name="robots" content="index, follow">
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <title>Type 4 Hair Style Picker | Natural Hair Inspiration & Trends</title>
</head>
<body>
    <h1>Pick Ya Fro, Sis</h1>
    <p class="hero">Your vibe. Your coils. Your Crown</p>
    <div class="main">
        <form class="sub1" method="POST">
            <div class="desc">
                <div class="box1">
                    <p>Clock them inches gurl!</p>
                    <div class="radio-inputs">
                        <label>
                            <input class="radio-input" type="radio" name="length" value="twa">
                                <span class="radio-tile">
                                    <span class="radio-icon">
                                        <img src="/assets/afro.png" alt="TWA" class="afro">
                                    </span>
                                    <span class="radio-label">Teenie Weenie Afro</span>
                                </span>
                        </label>
                        <label>
                            <input class="radio-input" type="radio" name="length" value="sl">
                                <span class="radio-tile">
                                    <span class="radio-icon">
                                        <img src="/assets/afro.png" alt="SLH" class="afro">
                                    </span>
                                    <span class="radio-label">Shoulder Length</span>
                                </span>
                        </label>
                        <label>
                            <input class="radio-input" type="radio" name="length" value="mbl">
                                <span class="radio-tile">
                                    <span class="radio-icon">
                                        <img src="/assets/afro.png" alt="MBL" class="afro">
                                    </span>
                                    <span class="radio-label">Mid-back Length</span>
                                </span>
                        </label>
                        <label>
                            <input class="radio-input" type="radio" name="length" value="wl">
                                <span class="radio-tile">
                                    <span class="radio-icon">
                                        <img src="/assets/afro.png" alt="WLH" class="afro">
                                    </span>
                                    <span class="radio-label">Waist Length</span>
                                </span>
                        </label>  
                    </div>                         
                </div>
                <div class="box2">
                    <p>Whats the vibe right now?</p>
                    <div class="radio-inputs">
                        <label>
                            <input class="radio-input" type="radio" name="state" value="braids">
                                <span class="radio-tile">
                                    <span class="radio-icon">
                                        <img src="/assets/afro.png" alt="TWA" class="afro">
                                    </span>
                                    <span class="radio-label">Braids / Extensions</span>
                                </span>
                        </label>
                        <label>
                            <input class="radio-input" type="radio" name="state" value="free">
                                <span class="radio-tile">
                                    <span class="radio-icon">
                                        <img src="/assets/afro.png" alt="TWA" class="afro">
                                    </span>
                                    <span class="radio-label">Out and Free</span>
                                </span>
                        </label>
                        <label>
                            <input class="radio-input" type="radio" name="state" value="mini">
                                <span class="radio-tile">
                                    <span class="radio-icon">
                                        <img src="/assets/afro.png" alt="TWA" class="afro">
                                    </span>
                                    <span class="radio-label">Mini braids/twists</span>
                                </span>
                        </label>
                    </div>
                </div>
            </div><br>
            <button type="submit">
                Generate hairstyle
            </button>
        </form>
        <div class="sub2">
            <img src="/assets/hair.gif" id="hair">
            <div id="loading" style="display:none;">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </div>
</body>
<script>
    
    const form = document.querySelector("form");
    const pinLink = document.getElementById('link'); 
    const hairstyleImg = document.getElementById('hair');
    const container = document.getElementsByClassName("sub2")[0];
    const loading = document.getElementById("loading");

    form.addEventListener("submit", (e) => {
      e.preventDefault()
      
      const frame = container.querySelector("iframe");
      if (frame) frame.remove();

      const lengthRadio = document.querySelector('input[name="length"]:checked');
      const stateRadio = document.querySelector('input[name="state"]:checked');
      const length = lengthRadio ? lengthRadio.value : null;
      const state = stateRadio ? stateRadio.value : null;

      hairstyleImg.style.display = "none";
      loading.style.display = "flex";

      if (!length || !state){
        window.alert("pick a struggle")
      }
      else {
        console.log(state, length)
        fetch('pickHair', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ length, state })
        })
        .then(res => res.json())
        .then(data => {
            console.log("are you there?")
            if (data.styleID) {
                const iframe = document.createElement("iframe");
                iframe.width = "300";   
                iframe.height = "500";  
                iframe.style.border = 'none';
                iframe.style.overflow = 'hidden';
                iframe.scrolling="no";
                iframe.setAttribute('allowtransparency', 'true');

                hairstyleImg.remove();
                iframe.src = `https://assets.pinterest.com/ext/embed.html?id=${data.styleID}`

                container.appendChild(iframe);

                iframe.onload = () => {
                    loading.style.display = "none";
                };
            } else {
                hairstyleImg.style.display = "block";
                loading.style.display = "none";
                alert('No matching hairstyles found!');
            }
        });
        }}
    );
</script>
</html>

<!-- INSERT INTO Styles VALUES ("985231164797811", "sl", "braids"),
("124623114682524931", "sl", "braids"),
("5277724559244087", "sl", "braids"),
("1196337404751451", "sl", "braids"),
("117656609010405972", "sl", "braids"),
("844493675364139", "sl", "braids"),
("8022105580080236", "sl", "braids"),
("435793701462209862", "sl", "braids"),
("68747532689", "sl", "braids"),
("336925615894780542", "sl", "braids"),
("1759287347951551", "sl", "braids"),
("985231163203009", "sl", "braids"); -->